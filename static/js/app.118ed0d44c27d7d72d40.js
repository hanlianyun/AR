webpackJsonp([0],{0:function(e,t){},Fgil:function(e,t){},IRhI:function(e,t){},NHnr:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=i("7+uW"),s={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"app"}},[t("router-view")],1)},staticRenderFns:[]};var n=i("VU/8")({name:"App",data:function(){return{}},methods:{}},s,!1,function(e){i("R1DF")},null,null).exports,o=i("/ocq"),r={name:"home",data:function(){return{msg:"Welcome to Your Vue.js App",show:!1,file:{},openImage:!1,openVideo:!1,image:"",video:"",nextPage:!1,tip:!1}},methods:{handleInput:function(e){alert(1),this.nextPage=!0,console.log(event),this.file=event.target.files[0];var t=new FileReader;t.readAsDataURL(this.file),t.onload=function(t){"image"===e?(this.openImage=!0,this.image=t.target.result):"video"===e&&(this.openVideo=!0,this.video=t.target.result)}.bind(this)},back:function(){this.nextPage=!1,this.tip=!1,this.file={},this.openImage=!1,this.openVideo=!1,this.image="",this.video=""},upLoad:function(){this.tip=!0},jump:function(e){this.$router.push({path:"/"+e})}}},c={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("div",{directives:[{name:"show",rawName:"v-show",value:!e.nextPage,expression:"!nextPage"}],staticClass:"shareDiv"},[i("div",{staticClass:"start"},[i("div",{staticClass:"startP"},[e._v("拍照"),i("input",{attrs:{type:"file",accept:"image/*",capture:"camera"},on:{change:function(t){e.handleInput("image")}}})]),e._v(" "),i("div",{staticClass:"startV",on:{click:function(t){e.jump("Video")}}},[e._v("录像")])])]),e._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:e.nextPage,expression:"nextPage"}],staticClass:"ReleaseDiv"},[i("div",{staticClass:"source"},[i("img",{directives:[{name:"show",rawName:"v-show",value:e.openImage,expression:"openImage"}],attrs:{src:e.image}}),e._v(" "),i("video",{directives:[{name:"show",rawName:"v-show",value:e.openVideo,expression:"openVideo"}],attrs:{src:e.video,autoplay:"",loop:""}})]),e._v(" "),i("div",{staticClass:"start"},[i("div",{staticClass:"back",on:{click:e.back}},[e._v("返回")]),e._v(" "),i("div",{staticClass:"startV",on:{click:e.upLoad}},[e._v("发布")])]),e._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:e.tip,expression:"tip"}],staticClass:"model"},[i("div",{staticClass:"success",on:{click:e.back}},[e._v("发布成功")])])])])},staticRenderFns:[]};var d=i("VU/8")(r,c,!1,function(e){i("Fgil")},null,null).exports,l={name:"HelloWorld",data:function(){return{msg:"Welcome to Your Vue.js App",picture:{done:!1},direction:0,exArray:[],timer:"",final:!1}},mounted:function(){this.openCamera()},methods:{openCamera:function(){navigator.mediaDevices.enumerateDevices().then(function(e){for(var t=0,i=e.length;t<i;t++)"videoinput"!==e[t].kind&&"video"!==e[t].kind||this.exArray.push(e[t].deviceId)}.bind(this));var e=this.$refs.video,t={audio:!1,video:{optional:[{sourceId:this.exArray[this.direction]}]}};navigator.mediaDevices.getUserMedia(t).then(function(t){e.srcObject=t,e.play()}).catch(function(e){console.log(e)})},change:function(){0===this.direction?this.direction=1:this.direction=0,this.openCamera()},take:function(){this.final=!0;var e=this.$refs.video,t=this.$refs.canvas,i=t.getContext("2d");t.width=window.innerWidth,t.height=window.innerHeight,i.drawImage(e,(640-480*window.innerWidth/window.innerHeight)/2,0,480*window.innerWidth/window.innerHeight,480,0,0,window.innerWidth,window.innerHeight)},again:function(){this.final=!1},jump:function(e){this.$router.push({path:"/"+e})}}},v={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"pictureDiv"},[i("div",{staticClass:"top"},[i("video",{directives:[{name:"show",rawName:"v-show",value:!e.final,expression:"!final"}],ref:"video",attrs:{autoplay:""}}),e._v(" "),i("canvas",{directives:[{name:"show",rawName:"v-show",value:e.final,expression:"final"}],ref:"canvas"})]),e._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:!e.final,expression:"!final"}],staticClass:"bottom"},[i("div",{staticClass:"photo"},[e.picture.done?i("img",{attrs:{src:"static/img/btn.png",width:"100%"}}):e._e(),i("input",{attrs:{type:"file",accept:"image/*"}})]),e._v(" "),i("div",{staticClass:"btn",on:{click:e.take}},[i("span",[e._v("点击拍照")]),i("div")]),e._v(" "),i("div",{staticClass:"metathesis",on:{click:e.change}})]),e._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:e.final,expression:"final"}],staticClass:"after"},[i("div",{staticClass:"again",on:{click:e.again}}),e._v(" "),i("div",{staticClass:"ok",on:{click:function(t){e.jump("Release")}}})])])},staticRenderFns:[]};var u=i("VU/8")(l,v,!1,function(e){i("f+SK")},null,null).exports,h={name:"HelloWorld",data:function(){return{msg:"Welcome to Your Vue.js App",picture:{done:!1},direction:0,exArray:[],mediaSource:{},recordVideo:!1,recordedChunks:[],sourceBuffer:null,theStream:null,theRecorder:null,final:!1,openVideo:!1,video:"",nextPage:!1,tip:!1}},mounted:function(){this.openCamera(),this.mediaSource=new MediaSource},methods:{openCamera:function(){navigator.mediaDevices.enumerateDevices().then(function(e){for(var t=0,i=e.length;t<i;t++)"videoinput"!==e[t].kind&&"video"!==e[t].kind||this.exArray.push(e[t].deviceId)}.bind(this));var e=this.$refs.video1,t={audio:!0,video:{optional:[{sourceId:this.exArray[this.direction]}]}};navigator.mediaDevices.getUserMedia(t).then(function(t){this.theStream=t,e.srcObject=t,e.play()}.bind(this)).catch(function(e){console.log(e)})},take:function(e){this.recordVideo=!0,this.$refs.video2.src=window.URL.createObjectURL(this.mediaSource),this.mediaSource.addEventListener("sourceopen",function(e){this.sourceBuffer=this.mediaSource.addSourceBuffer('video/webm; codecs="opus,vp8"')}.bind(this),!1);var t=void 0;try{t=new MediaRecorder(this.theStream)}catch(e){return void console.error("Exception while creating MediaRecorder: "+e)}this.theRecorder=t,console.log("MediaRecorder created"),t.ondataavailable=this.recorderOnDataAvailable,t.start(100)},recorderOnDataAvailable:function(e){if(0!==e.data.size){this.recordedChunks.push(e.data);var t=new FileReader;t.addEventListener("loadend",function(){var e=new Uint8Array(t.result);this.sourceBuffer.appendBuffer(e)}.bind(this)),t.readAsArrayBuffer(e.data)}},end:function(){try{this.final=!0,this.theRecorder.stop(),this.theStream.getTracks()[0].stop();var e=new Blob(this.recordedChunks,{type:"video/webm"}),t=(window.URL||window.webkitURL).createObjectURL(e);this.video=t}catch(e){console.log(e)}},again:function(){this.recordVideo=!1,this.final=!1},back:function(){this.nextPage=!1,this.tip=!1,this.openVideo=!1,this.video=""},upLoad:function(){var e=new FormData,t=new Blob(this.recordedChunks,{type:"video/webm"});console.log(this.recordedChunks),console.log(t),e.append("videofile",t,(new Date).getTime()+".webm"),console.log(e.getAll("videofile"));console.log(e),this.$http.post("/api/upload",e,{headers:{"Content-Type":"application/octet-stream"},responseType:"blob"}).then(function(e){console.log(e)})},dataURItoBlob:function(e){for(var t=e,i=e.split(",")[0].split(":")[1].split(";")[0],a=new ArrayBuffer(t.length),s=new Uint8Array(a),n=0;n<t.length;n++)s[n]=t.charCodeAt(n);return new Blob([a],{type:i})},jump:function(e){this.$refs.video3.play(),this.nextPage=!0,this.openVideo=!0}}},p={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("div",{directives:[{name:"show",rawName:"v-show",value:!e.nextPage,expression:"!nextPage"}],staticClass:"pictureDiv"},[i("div",{staticClass:"top"},[i("video",{directives:[{name:"show",rawName:"v-show",value:!e.recordVideo,expression:"!recordVideo"}],ref:"video1",attrs:{autoplay:""}}),e._v(" "),i("video",{directives:[{name:"show",rawName:"v-show",value:e.recordVideo,expression:"recordVideo"}],ref:"video2",attrs:{autoplay:""}})]),e._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:!e.final,expression:"!final"}],staticClass:"bottom"},[i("div",{staticClass:"btn"},[i("span",[e._v("点击录像[最长10秒]")]),i("div",{on:{touchstart:e.take,touchend:e.end}})])]),e._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:e.final,expression:"final"}],staticClass:"after"},[i("div",{staticClass:"again",on:{click:e.again}}),e._v(" "),i("div",{staticClass:"ok",on:{click:function(t){e.jump("Release")}}})])]),e._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:e.nextPage,expression:"nextPage"}],staticClass:"ReleaseDiv"},[i("div",{staticClass:"source"},[i("video",{directives:[{name:"show",rawName:"v-show",value:e.openVideo,expression:"openVideo"}],ref:"video3",attrs:{src:e.video,autoplay:e.nextPage,loop:""}})]),e._v(" "),i("div",{staticClass:"start"},[i("div",{staticClass:"back",on:{click:e.back}},[e._v("返回")]),e._v(" "),i("div",{staticClass:"startV",on:{click:e.upLoad}},[e._v("发布")])]),e._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:e.tip,expression:"tip"}],staticClass:"model"},[i("div",{staticClass:"success",on:{click:e.back}},[e._v("发布成功")])])])])},staticRenderFns:[]};var m=i("VU/8")(h,p,!1,function(e){i("IRhI")},null,null).exports,f={name:"home",props:["file"],data:function(){return console.log(this),{msg:"Welcome to Your Vue.js App",image:"",tip:!1}},mounted:function(){console.log(this.file),this.file.length>0&&(this.image=this.file)},methods:{back:function(){this.$router.go(-1)},upLoad:function(){this.tip=!0},jump:function(e){this.$router.push({path:"/"+e})}}},w={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"ReleaseDiv"},[i("div",{staticClass:"source"},[i("img",{attrs:{src:e.image}})]),e._v(" "),i("div",{staticClass:"start"},[i("div",{staticClass:"back",on:{click:e.back}},[e._v("返回")]),e._v(" "),i("div",{staticClass:"startV",on:{click:e.upLoad}},[e._v("发布")])]),e._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:e.tip,expression:"tip"}],staticClass:"model"},[i("div",{staticClass:"success",on:{click:function(t){e.jump("Share")}}},[e._v("发布成功")])])])},staticRenderFns:[]};var g=i("VU/8")(f,w,!1,function(e){i("gJfS")},null,null).exports;a.a.use(o.a);var C=new o.a({routes:[{path:"/",redirect:{name:"Share"}},{path:"/Share",name:"Share",component:d},{path:"/Picture",name:"Picture",component:u},{path:"/Video",name:"Video",component:m},{path:"/Release",name:"Release",component:g}]}),x=i("NYxO");a.a.use(x.a);var _=new x.a.Store({state:{show:!1}}),k=i("8+8L");i("txPn"),a.a.use(k.a),a.a.config.productionTip=!1,new a.a({el:"#app",router:C,store:_,template:"<App/>",components:{App:n}})},R1DF:function(e,t){},"f+SK":function(e,t){},gJfS:function(e,t){},txPn:function(e,t,i){var a=i("zNUS");a.mock("/api/data",function(e,t){return{data:["a","b"]}}),a.mock("/api/upload","post",function(e,t){return console.log(e.body.videofile),"success"})}},["NHnr"]);
//# sourceMappingURL=app.118ed0d44c27d7d72d40.js.map